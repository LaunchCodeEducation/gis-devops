<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Certificates &#8212; LaunchCode Curriculum Docs  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/launchcode.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/lc-logo.svg"></span>
          GIS DevOps</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day1/index.html">Week 1 - Day 1: Git, GitLab, IntelliJ, Refactoring, Unit Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#slides">Slides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#exercises">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day1/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day2/index.html">Week 1 - Day 2: Security, Test-driven development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day2/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day2/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day2/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day2/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day3/index.html">Week 1 - Day 3: Integration testing, dependency injection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day3/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day3/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day3/index.html#studio">Studio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day4/index.html">Week 1 - Day 4: Postgres, Spring Data, JPA, Hibernate</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day4/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day4/index.html#walkthroughs">Walkthroughs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day4/index.html#studio">Studio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day5/index.html">Week 1 - Day 5: AJAX, Open Layers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day5/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day5/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day5/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day5/index.html#retro">Retro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/day5/index.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week02/project/index.html">Week 2 - Project Week - Zika Mission Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#project">Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#project-hints">Project Hints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#setup-project">Setup Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#setup-postgres">Setup Postgres</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#turning-in-your-work">Turning In Your Work</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#bonus-missions">Bonus Missions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week02/project/index.html#resources">Resources</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day1/index.html">Week 3 - Day 1: RESTful web services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day1/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day1/index.html#walkthroughs">Walkthroughs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day1/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day1/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day2/index.html">Week 3 - Day 2 Swagger REST framework</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day2/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day2/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day2/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day2/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day3/index.html">Week 3 - Day 3: Intro to Elasticsearch</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day3/index.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day3/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day3/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day3/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day4/index.html">Week 3 - Day 4: More Elasticsearch, Integrating ES with Spring</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day4/index.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day4/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day4/index.html#studios">Studios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day4/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day4/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day5/index.html">Week 3 - Day 5: ES2015, ESLint, OpenLayers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day5/index.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day5/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day5/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day5/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day5/index.html#retro">Retro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/day5/index.html#resources">Resources</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week04/project/index.html">Week 4 - Project Week - Zika Mission Control Part 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week04/project/index.html#project">Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week04/project/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week04/project/index.html#getting-the-code">Getting the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week04/project/index.html#what-s-new-in-the-code">What’s new in the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week04/project/index.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week04/project/index.html#suggested-endpoints-parameters">Suggested Endpoints/Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week04/project/index.html#database-setup">Database Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week04/project/index.html#bonus-missions">Bonus Missions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week04/project/index.html#walkthrough-on-creating-the-location-data">Walkthrough on Creating the Location Data</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week05/day1/index.html">Week 5 - Day 1: Intro to DevOps/AWS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day1/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day1/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day1/index.html#studio">Studio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/day2/index.html">Week 5 - Day 2: More with AWS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day2/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day2/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day2/index.html#studio">Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day2/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/day3/index.html">Week 5 - Day 3: 12 Factor Apps and Auto Scaling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day3/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day3/index.html#studio">Studio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/day4/index.html">Week 5 - Day 4: Gradle, Continuous Integration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day4/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day4/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day4/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/day5/index.html">Week 5 - Day 5: Sonarqube</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day5/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day5/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week05/day5/index.html#retro">Retro</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week06/project/index.html">Week 6 - Project Week - Zika Mission Control Part 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week06/project/index.html#project">Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week06/project/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week06/project/index.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week06/project/index.html#new-stuff">New Stuff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week06/project/index.html#setup-locally">Setup Locally</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week06/project/index.html#setup-in-the-cloud">Setup in the Cloud</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week08/project/index.html">Week 8 - Project Week - Zika Mission Control Part 4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week08/project/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week08/project/index.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week08/project/index.html#new-stuff">New Stuff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week08/project/index.html#setup-locally">Setup Locally</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week08/project/index.html#setup-in-the-cloud">Setup in the Cloud</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../week09/day3/index.html">Week 9 - Day 3: Intro to Docker</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day3/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day3/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day3/index.html#studio">Studio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week09/day4/index.html">Week 9 - Day 4: OAuth2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day4/index.html#lesson">Lesson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day4/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week09/day5/index.html">Week 9 - Day 5: Certificates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day5/index.html#lesson-content">Lesson Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day5/index.html#walkthrough">Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day5/index.html#resources">Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/day5/index.html#retro">Retro</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Certificates</a><ul>
<li><a class="reference internal" href="#spring-security">Spring Security</a></li>
<li><a class="reference internal" href="#setup">Setup</a></li>
<li><a class="reference internal" href="#simple-security-with-spring">Simple Security With Spring</a><ul>
<li><a class="reference internal" href="#set-and-use-username-password">Set and Use Username/Password</a></li>
</ul>
</li>
<li><a class="reference internal" href="#certificates-with-spring-security">Certificates with Spring Security</a></li>
<li><a class="reference internal" href="#certificate-setup">Certificate Setup</a><ul>
<li><a class="reference internal" href="#create-keystore">Create Keystore</a></li>
<li><a class="reference internal" href="#create-certificate">Create Certificate</a></li>
<li><a class="reference internal" href="#create-truststore">Create Truststore</a></li>
<li><a class="reference internal" href="#add-certificate-to-keystore">Add Certificate to Keystore</a></li>
<li><a class="reference internal" href="#what-just-happened">What Just Happened?</a></li>
<li><a class="reference internal" href="#connect-spring-security-to-your-keystore-and-certificate">Connect Spring Security to your Keystore and Certificate</a></li>
<li><a class="reference internal" href="#configure-intellij-run-configurations">Configure Intellij Run Configurations</a></li>
<li><a class="reference internal" href="#connection-is-not-secure">Connection is Not Secure</a></li>
<li><a class="reference internal" href="#add-certificate-to-the-browser">Add Certificate to the Browser</a></li>
</ul>
</li>
<li><a class="reference internal" href="#client-certificates">Client Certificates</a></li>
<li><a class="reference internal" href="#run-the-application">Run the Application</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="certificates">
<span id="walkthrough-certificates"></span><h1>Certificates<a class="headerlink" href="#certificates" title="Permalink to this headline">¶</a></h1>
<p>In this walkthrough, we will be looking at how a servers use certificates to validate their identity.</p>
<div class="section" id="spring-security">
<h2>Spring Security<a class="headerlink" href="#spring-security" title="Permalink to this headline">¶</a></h2>
<p>For this walkthrough, we will be using <a class="reference external" href="https://docs.spring.io/spring-security/site/docs/4.2.8.RELEASE/reference/htmlsingle/">Spring Security</a> to secure our application.  Spring Security will enable us to use username/password, client certificates, and attach a certificate to our server.</p>
</div>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Check out the <a class="reference external" href="https://gitlab.com/LaunchCodeTraining/x509-certificate-starter">Server Certificate Repo</a> from Gitlab</li>
<li>Review the starter code<ol class="arabic">
<li><code class="docutils literal notranslate"><span class="pre">UserController</span></code> that checks the certificate of the user</li>
<li>A properties file that defines the <code class="docutils literal notranslate"><span class="pre">jks</span></code>, the <code class="docutils literal notranslate"><span class="pre">truststore</span></code>, and other configuration for SSL.</li>
<li>A Makefile in <code class="docutils literal notranslate"><span class="pre">src/main/resources/certs</span></code> that contains commands to simplify the process of creating certificates.</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="simple-security-with-spring">
<h2>Simple Security With Spring<a class="headerlink" href="#simple-security-with-spring" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>In your browser go to <a class="reference external" href="http://localhost:8080/user">http://localhost:8080/user</a></li>
<li>You should see a login prompt<ul>
<li>This prompt is created by the browser as part of <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_access_authentication">Basic Access Authentication</a></li>
<li>NOTE: <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_access_authentication">Basic Access Authentication</a> is not secure by itself, it should be used with <code class="docutils literal notranslate"><span class="pre">HTTPS</span></code></li>
</ul>
</li>
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Basic_access_authentication">Basic Access Authentication</a> is enabled because Spring Security is included in the <code class="docutils literal notranslate"><span class="pre">gradle</span></code> file</li>
</ol>
<div class="section" id="set-and-use-username-password">
<h3>Set and Use Username/Password<a class="headerlink" href="#set-and-use-username-password" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Create a <strong>Run Configuration</strong> that will run the <code class="docutils literal notranslate"><span class="pre">bootRun</span></code> task</li>
<li>In <strong>Run Configuration</strong>, add the below <strong>Environment Variables</strong> and values<ul>
<li><code class="docutils literal notranslate"><span class="pre">APP-USERNAME</span></code> = adminUser</li>
<li><code class="docutils literal notranslate"><span class="pre">APP-PASSWORD</span></code> = changeit</li>
<li>For now ignore the other commented out values in <code class="docutils literal notranslate"><span class="pre">application.properties</span></code></li>
</ul>
</li>
<li>Run <code class="docutils literal notranslate"><span class="pre">bootRun</span></code> task via <strong>Run Configuration</strong> menu</li>
<li>Go to <a class="reference external" href="http://localhost:8080/user">http://localhost:8080/user</a></li>
<li>Enter the username/password you have stored in <strong>Run Configuration</strong></li>
</ol>
</div>
</div>
<div class="section" id="certificates-with-spring-security">
<h2>Certificates with Spring Security<a class="headerlink" href="#certificates-with-spring-security" title="Permalink to this headline">¶</a></h2>
<p>We want to add HTTPS to our web application using Spring Security.</p>
</div>
<div class="section" id="certificate-setup">
<h2>Certificate Setup<a class="headerlink" href="#certificate-setup" title="Permalink to this headline">¶</a></h2>
<p>After checking out the example project, you will neeed to generate the cryptographic components required for Spring Boot to host a certificate.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">jks</span></code> also known as a <code class="docutils literal notranslate"><span class="pre">Java</span> <span class="pre">Key</span> <span class="pre">Store</span></code> will need to be generated.  Since we will be using a self-signed certificate, this <code class="docutils literal notranslate"><span class="pre">jks</span></code> file will act as our local Certificate Authority.  Run the following command (be sure to use a secure password!):</p>
<div class="section" id="create-keystore">
<h3>Create Keystore<a class="headerlink" href="#create-keystore" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make create-keystore PASSWORD=changeit
$ # Generate a certificate authority (CA)
keytool -genkey -alias ca -ext BC=ca:true \
                -keyalg RSA -keysize 4096 -sigalg SHA512withRSA -keypass changeit \
                -validity 3650 -dname &#39;CN=LaunchCode CA,OU=launchcode.org,O=LaunchCode,L=Saint Louis,ST=Missouri,C=CC&#39; \
                -keystore keystore.jks -storepass changeit
</pre></div>
</div>
<p>By doing an <code class="docutils literal notranslate"><span class="pre">ls</span></code>, you should now see that you <code class="docutils literal notranslate"><span class="pre">keystore.jks</span></code> file in your directory.</p>
</div>
<div class="section" id="create-certificate">
<h3>Create Certificate<a class="headerlink" href="#create-certificate" title="Permalink to this headline">¶</a></h3>
<p>Next you will create a certificate for you local development environment. Run the following command::</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make add-host HOSTNAME=localhost PASSWORD=changeit
</pre></div>
</div>
<p>Running <code class="docutils literal notranslate"><span class="pre">ls</span></code> will show that there are now two additional files in your director: <code class="docutils literal notranslate"><span class="pre">localhost.csr</span></code> and <code class="docutils literal notranslate"><span class="pre">localhost.cst</span></code>.</p>
</div>
<div class="section" id="create-truststore">
<h3>Create Truststore<a class="headerlink" href="#create-truststore" title="Permalink to this headline">¶</a></h3>
<p>Next, you will need to create a <code class="docutils literal notranslate"><span class="pre">truststore</span></code>.  The <code class="docutils literal notranslate"><span class="pre">truststore</span></code> is where all trusted certificates are located.  It is essentially the <code class="docutils literal notranslate"><span class="pre">known_hosts</span></code> for certificates.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make create-truststore PASSWORD=changeit
# Export certificate authority
keytool -export -alias ca -file ca.crt -rfc \
                -keystore keystore.jks -storepass changeit
Certificate stored in file &lt;ca.crt&gt;
# Import certificate authority into a new truststore
keytool -import -trustcacerts -noprompt -alias ca -file ca.crt \
                -keystore truststore.jks -storepass changeit
Certificate was added to keystore
</pre></div>
</div>
<p>Running <code class="docutils literal notranslate"><span class="pre">ls</span></code> will show that two more files have been added to your directory: <code class="docutils literal notranslate"><span class="pre">ca.crt</span></code> and <code class="docutils literal notranslate"><span class="pre">truststore.jks</span></code>.</p>
</div>
<div class="section" id="add-certificate-to-keystore">
<h3>Add Certificate to Keystore<a class="headerlink" href="#add-certificate-to-keystore" title="Permalink to this headline">¶</a></h3>
<p>Next, you will add the certificate that you generated to the <code class="docutils literal notranslate"><span class="pre">truststore.jks</span></code> so that your user can access the site.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make add-client CLIENTNAME=cid
//output
keytool -genkey -alias cid \
                -keyalg RSA -keysize 4096 -sigalg SHA512withRSA -keypass changeit \
                -validity 3650 -dname &#39;CN=cid,OU=launchcode.com,O=LaunchCode,L=Saint Louis,ST=Missouri,C=CC&#39; \
                -keystore truststore.jks -storepass changeit
# Generate a host certificate signing request
keytool -certreq -alias cid -ext BC=ca:true \
                -keyalg RSA -keysize 4096 -sigalg SHA512withRSA \
                -validity 3650 -file &quot;cid.csr&quot; \
                -keystore truststore.jks -storepass changeit
# Generate signed certificate with the certificate authority
keytool -gencert -alias ca \
                -validity 3650 -sigalg SHA512withRSA \
                -infile &quot;cid.csr&quot; -outfile &quot;cid.crt&quot; -rfc \
                -keystore keystore.jks -storepass changeit
# Import signed certificate into the truststore
keytool -import -trustcacerts -alias cid \
                -file &quot;cid.crt&quot; \
                -keystore truststore.jks -storepass changeit
Certificate reply was installed in keystore
# Export private certificate for importing into a browser
keytool -importkeystore -srcalias cid \
                -srckeystore truststore.jks -srcstorepass changeit \
                -destkeystore &quot;cid.p12&quot; -deststorepass changeit \
                -deststoretype PKCS12
</pre></div>
</div>
</div>
<div class="section" id="what-just-happened">
<h3>What Just Happened?<a class="headerlink" href="#what-just-happened" title="Permalink to this headline">¶</a></h3>
<p>A lot just happened, let’s review.</p>
<ul class="simple">
<li>First, it needs to create a key for your user. A key is created and placed in the <code class="docutils literal notranslate"><span class="pre">keystore.jks</span></code>.</li>
<li>Second, a signing requrest <code class="docutils literal notranslate"><span class="pre">.csr</span></code> file was generated based on the key.  This is what is used to aske the Certificate Authority to sign your certificate.</li>
<li>Third, the signing requrest <code class="docutils literal notranslate"><span class="pre">.csr</span></code> is passed to the Certificate Authority and a signed certificate is passed back as the <code class="docutils literal notranslate"><span class="pre">cid.crt</span></code>.</li>
<li>Fourth, the <code class="docutils literal notranslate"><span class="pre">cid.crt</span></code> file is stored in the <code class="docutils literal notranslate"><span class="pre">truststore.jks</span></code>.</li>
<li>Fifth and finally, the <code class="docutils literal notranslate"><span class="pre">cid.crt</span></code> file needs to be exported so that it can be included in the browser.  The result is a <code class="docutils literal notranslate"><span class="pre">cid.p12</span></code> file that can be given to the user and used to authenticate against an X509 server.</li>
</ul>
</div>
<div class="section" id="connect-spring-security-to-your-keystore-and-certificate">
<h3>Connect Spring Security to your Keystore and Certificate<a class="headerlink" href="#connect-spring-security-to-your-keystore-and-certificate" title="Permalink to this headline">¶</a></h3>
<p>There are specific properties in <code class="docutils literal notranslate"><span class="pre">application.properties</span></code> that configure Spring Security and Tomcat server settings. <a class="reference external" href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-security.html">More information on Spring Security Users</a></p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">security.user.name</span></code> = set a default username for spring security, these can be dynamically loaded</li>
<li><code class="docutils literal notranslate"><span class="pre">security.user.password</span></code> = set a default username for spring security, these can be dynamically loaded</li>
<li><code class="docutils literal notranslate"><span class="pre">server.ssl.key-store</span></code> = where the keystore is located</li>
<li><code class="docutils literal notranslate"><span class="pre">server.ssl.key-store-password</span></code> = password for the keystore</li>
<li><code class="docutils literal notranslate"><span class="pre">server.ssl.key-alias</span></code> = alias listed on certificate</li>
<li><code class="docutils literal notranslate"><span class="pre">server.ssl.key-password</span></code> = password used to create certificate</li>
<li><code class="docutils literal notranslate"><span class="pre">server.ssl.enabled</span></code> = enable SSL in Tomcat</li>
<li><code class="docutils literal notranslate"><span class="pre">server.port</span></code> = not security specific, but the port that Tomcat will be listning for requests on</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Port 8443 is the alternate SSL port. The default SSL port is 443</p>
</div>
</div>
<div class="section" id="configure-intellij-run-configurations">
<h3>Configure Intellij Run Configurations<a class="headerlink" href="#configure-intellij-run-configurations" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Add <code class="docutils literal notranslate"><span class="pre">CERT-PASSWORD</span></code> and it’s value to <strong>Environment Variables</strong> in <strong>Run Configurations</strong><ul>
<li><code class="docutils literal notranslate"><span class="pre">CERT-PASSWORD</span></code> = The password you used to create keystore and certificate in previous section</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="connection-is-not-secure">
<h3>Connection is Not Secure<a class="headerlink" href="#connection-is-not-secure" title="Permalink to this headline">¶</a></h3>
<p>Let’s try out our app and see what happens.</p>
<ol class="arabic simple">
<li>Uncomment all properties in <code class="docutils literal notranslate"><span class="pre">application.properties</span></code></li>
<li>Set all values in <strong>Run Configurations</strong></li>
<li>Run or ReRun <code class="docutils literal notranslate"><span class="pre">bootRun</span></code> task</li>
<li>Go to <code class="docutils literal notranslate"><span class="pre">https://localhost:8443/</span></code> in your browser</li>
<li>You should see this</li>
</ol>
<img alt="_static/image/insecure-connection.png" src="_static/image/insecure-connection.png" />
</div>
<div class="section" id="add-certificate-to-the-browser">
<h3>Add Certificate to the Browser<a class="headerlink" href="#add-certificate-to-the-browser" title="Permalink to this headline">¶</a></h3>
<p>Upon running the app, navigate to <a class="reference external" href="https://localhost:8443">https://localhost:8443</a>.  Notice that the app is now running on <code class="docutils literal notranslate"><span class="pre">https</span></code>.  This says that all traffic going over the write is encrypted.  The only question is “Do you trust the person that you are talking to?”.</p>
<p>The first thing you will notice is that your browser doesn’t recognize the certificate from the server. Anytime there is a bad certificate on a server, your browser will freak out.  Let’s fix that.</p>
<p>Open the Settings tab on Chrome (or the browser of your choie).</p>
<blockquote>
<div><img alt="../../_images/settings-bar.png" src="../../_images/settings-bar.png" />
</div></blockquote>
<p>Under Advanced Settings, you will find the link to the <code class="docutils literal notranslate"><span class="pre">Privacy</span> <span class="pre">and</span> <span class="pre">security</span></code> page.</p>
<blockquote>
<div><img alt="../../_images/advanced-settings.png" src="../../_images/advanced-settings.png" />
</div></blockquote>
<p>Finally, you should find the <code class="docutils literal notranslate"><span class="pre">Manage</span> <span class="pre">certificates</span></code> link on the page to be able to configure the certificates your browser trusts.</p>
<blockquote>
<div><img alt="_static/image/manage-certificates.png" src="_static/image/manage-certificates.png" />
</div></blockquote>
<p>By clicking on <code class="docutils literal notranslate"><span class="pre">Certificates</span></code> in the bottom left hand corner of the screen, you should be able to see all of the certificates your browser supports.  They may be spread across several keychains. Be sure that you do not have any certificates selected otherwise the “+” button will not be enabled.</p>
<blockquote>
<div><img alt="../../_images/adding-certificate.png" src="../../_images/adding-certificate.png" />
</div></blockquote>
<p>Click the “+” button and add the <cite>localhost.crt</cite> certificate that you had generated earlier in the walkthrough.</p>
</div>
</div>
<div class="section" id="client-certificates">
<h2>Client Certificates<a class="headerlink" href="#client-certificates" title="Permalink to this headline">¶</a></h2>
<p>Adding client-side certificates for Authorization</p>
<p>Open the Keychain Access program again and click on <code class="docutils literal notranslate"><span class="pre">MyCertificates</span></code>.  These are the client-side certificates that are currently installed on your compuster and that can be used to access a remote server.  Let’s add a new certificate by clicking <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">&gt;</span> <span class="pre">Import</span> <span class="pre">Items...</span></code>.  Import the <code class="docutils literal notranslate"><span class="pre">cid.p12</span></code> file that you created earlier in the studio.</p>
<blockquote>
<div><img alt="../../_images/import-clientside-cert.png" src="../../_images/import-clientside-cert.png" />
</div></blockquote>
<p>After adding the client-side cert your browser will ask you to select a certificate</p>
</div>
<div class="section" id="run-the-application">
<h2>Run the Application<a class="headerlink" href="#run-the-application" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>In Intellij run the <code class="docutils literal notranslate"><span class="pre">bootRun</span></code> task via <strong>Run Configurations</strong> menu</li>
<li>Make sure you application starts without errors</li>
<li>Then visit <code class="docutils literal notranslate"><span class="pre">https://localhost:8443/user</span></code> in your browser (the one configured to use the Certificate Authority)</li>
</ul>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/walkthroughs/certificates/index.rst.txt"
     rel="nofollow">Page Source</a>
</div>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>