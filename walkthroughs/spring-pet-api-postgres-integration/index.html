<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Spring Postgres Integration &#8212; LaunchCode: GIS DevOps  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fa/css/all.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/launchcode.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Walkthrough: SwaggerUI via SpringFox" href="../springfox-swagger/index.html" />
    <link rel="prev" title="Walkthrough: Spring Integration Tests" href="../spring-integration-testing/index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/lc-ed-logo.png" alt="LaunchCode logo"></span>
          GIS DevOps</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="/installations/index.html">Installations</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ol>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day1/index.html">Week 1 - Day 1: Welcome, Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day2/index.html">Week 1 - Day 2: Terminal, Shell, Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day3/index.html">Week 1 - Day 3: Shell, Git, SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day4/index.html">Week 1 - Day 4: SQL, HTTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/day5/index.html">Week 1 - Day 5: HTTP, Docker</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day1/index.html">Week 2 - Day 1: HTML, CSS, Browser DevTools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day2/index.html">Week 2 - Day 2: HTML/CSS Template, JavaScript Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day3/index.html">Week 2 - Day 3: Programming Fundamentals, JavaScript, DOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day4/index.html">Week 2 - Day 4: JS, DOM, Promises, AJAX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/day5/index.html">Week 2 - Day 5: Promises, AJAX, HTTP</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day1/index.html">Week 3 - Day 1: Java, OOP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day2/index.html">Week 3 - Day 2: Spring Boot, Controllers, Routes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day3/index.html">Week 3 - Day 3: Models, ORM (Hibernate)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day4/index.html">Week 3 - Day 4: Persistence, ORM Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/day5/index.html">Week 3 - Day 5: Review</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day1/index.html">Week 4 - Day 1: Git, GitLab, IntelliJ, Refactoring, Unit Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day2/index.html">Week 4 - Day 2: Security, Test-driven development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day3/index.html">Week 4 - Day 3: Integration testing, dependency injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day4/index.html">Week 4 - Day 4: Postgres, Spring Data, JPA, Hibernate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/day5/index.html">Week 4 - Day 5: AJAX, Open Layers</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week05/project/index.html">Week 5 - Project Week: Zika Mission Control</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day1/index.html">Week 6 - Day 1: RESTful web services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day2/index.html">Week 6 - Day 2: Swagger REST framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day3/index.html">Week 6 - Day 3: Intro to Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day4/index.html">Week 6 - Day 4: More Elasticsearch, Integrating ES with Spring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week06/day5/index.html">Week 6 - Day 5: ES2015, ESLint, OpenLayers</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week07/project/index.html">Week 7 - Project Week: Zika Mission Control Part 2</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day1/index.html">Week 8 - Day 1: Intro to DevOps/AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day2/index.html">Week 8 - Day 2: More with AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day3/index.html">Week 8 - Day 3: 12 Factor Apps and Auto Scaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day4/index.html">Week 8 - Day 4: Gradle, Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/day5/index.html">Week 8 - Day 5: Sonarqube</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week09/project/index.html">Week 9 - Project Week: Zika Mission Control Part 3</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week11/project/index.html">Week 11 - Project Week: Zika Mission Control Part 4</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../week12/day3/index.html">Week 12 - Day 3: Intro to Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week12/day4/index.html">Week 12 - Day 4: OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week12/day5/index.html">Week 12 - Day 5: Certificates</a></li>
</ol>
<ol class="current">
<li class="toctree-l1"><a class="reference internal" href="../aws-intro/index.html">Walkthrough: Intro to AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws-rds-walkthrough/index.html">Walkthrough: RDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client-certificates/index.html">Client Certificates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client-deployment-s3/index.html">Deploy Zika Client to S3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../curl/index.html">Walkthrough: Intro to Curl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/index.html">Walkthrough: Intro to Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elasticsearch-spring/index.html">Walkthrough: Elasticsearch in Spring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elasticsearch/index.html">Walkthrough: Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elasticsearch2/index.html">Walkthrough: Elasticsearch Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eslint-airwaze/index.html">Walkthrough: ESLint Airwaze</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gitLab/index.html">Walkthrough: Git and Gitlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gradle/index.html">Walkthrough: Gradle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hashing-salting/index.html">Walkthrough: Hashing and Salting Passwords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jenkins/index.html">Walkthrough: CI/CD With Jenkins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../launchcart-rest/index.html">Walkthrough: LaunchCart REST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nginx-proxy-spring/index.html">NGINX as a Proxy to Spring Apache Tomcat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oauth2/index.html">Visual OAuth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openlayers/index.html">Walkthrough: OpenLayers and jQuery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postgress/index.html">Walkthrough: PostgreSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sonarqube/index.html">Walkthrough: Sonarqube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spring-data-jpa-hibernate/index.html">Walkthrough: Cars Demo - Spring Data, JPA, Hibernate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spring-integration-testing/index.html">Walkthrough: Spring Integration Tests</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Spring Postgres Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../springfox-swagger/index.html">Walkthrough: SwaggerUI via SpringFox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../swagger/index.html">Walkthrough: SwaggerUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tdd/index.html">Walkthrough: TDD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../todo-tasks-single-ec2-deployment/index.html">Todo Tasks Deployment Single EC2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit-files/index.html">Running a Java Application as a Linux Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit-tests/index.html">Walkthrough: Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading-spring-boot/index.html">Walkthrough: Upgrading to Spring Boot 2.x</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watch-todo-tasks-deployment/index.html">Watch a Todo Tasks Deployment</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../studios/airwaze/index.html">Studio: Airwaze</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/aws-EC2-basics/index.html">Studio: AWS Devops Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/aws-auto-scaling/index.html">Scaling horizontally AutoScaling Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/aws-rds-vpc/index.html">Studio: AWS RDS VPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/curl/index.html">Curl Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/elasticsearch1/index.html">Elasticsearch Query Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/elasticsearch2/index.html">Elasticsearch Queries Studio 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/junit/index.html">Studio: JUnit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/launchcart-rest/index.html">Studio: LaunchCart REST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/launchcart1/index.html">Studio: LaunchCart Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/launchcart2/index.html">Studio: LaunchCart Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/openlayers-es2015/index.html">Studio: OpenLayers ES2015 Workshop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/swagger/index.html">Studio: Springfox and Swagger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../studios/tdd/index.html">Studio: Test-Driven Development</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../project-requirements/deploy-mapnotes-api-single-ec2/index.html">Project: Deploy Map Notes to a Single EC2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../project-requirements/mapnotes-api/index.html">Project: Map Notes API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../project-requirements/mapnotes-pipeline/index.html">Project: Mapnotes API Jenkins Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../project-requirements/mapnotes-rds/index.html">Project: Map Notes Backed by AWS RDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../project-requirements/zika-client-rest/index.html">Project: Zika Client REST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../project-requirements/zika-client/index.html">Project: Zika Client</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../installations/00-prep-week/index.html">Installation: Essential Tooling &amp; Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/01-docker/index.html">Installation: Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/02-docker-psql/index.html">Installation: Docker PSQL Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/03-docker-postgis/index.html">Installation: Docker PostGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/04-docker-elasticsearch/index.html">Installation: Docker Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/05-docker-kibana/index.html">Installation: Docker Kibana</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installations/06-docker-jenkins/index.html">Installation: Docker Jenkins</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/00-intellij/index.html">Configuration: IntelliJ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/01-runtime-configurations/index.html">Configuration: IntelliJ - Runtime Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/02-environment-variables-intellij/index.html">Configuration: Environment Variables - IntelliJ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/04-spring-elasticsearch/index.html">Configuration: Spring &amp; Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/05-spring-postgres/index.html">Configuration: Spring &amp; Postgres</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations/06-vscode-eslint/index.html">Configuration: Visual Studio Code - ESLint</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../notes/docker/index.html">Docker</a></li>
</ol>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
    <label for="q" class="searchLabel">Search</label>
    <input type="text" name="q" class="form-control" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Spring Postgres Integration</a><ul>
<li><a class="reference internal" href="#setup">Setup</a></li>
<li><a class="reference internal" href="#create-a-postgres-database-for-this-project">Create a Postgres Database for this project</a><ul>
<li><a class="reference internal" href="#stopping-other-postgres-containers">Stopping Other Postgres Containers</a></li>
<li><a class="reference internal" href="#creating-the-spring-example-postgres-container">Creating the spring-example Postgres Container</a></li>
<li><a class="reference internal" href="#configure-database-for-project">Configure Database for project</a></li>
</ul>
</li>
<li><a class="reference internal" href="#add-dependencies-to-spring-project">Add Dependencies to Spring Project</a></li>
<li><a class="reference internal" href="#add-database-configuration-information-to-spring-project">Add Database Configuration Information to Spring Project</a></li>
<li><a class="reference internal" href="#model-annotations">Model Annotations</a></li>
<li><a class="reference internal" href="#datarepository">DataRepository</a></li>
<li><a class="reference internal" href="#working-with-the-data-repository">Working with the Data Repository</a></li>
<li><a class="reference internal" href="#try-it-out">Try it Out!</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="spring-postgres-integration">
<span id="spring-pet-api-postgres-integration"></span><h1>Spring Postgres Integration<a class="headerlink" href="#spring-postgres-integration" title="Permalink to this headline">¶</a></h1>
<p>Our goal is to integrate Postgres with our Spring application.</p>
<p>To accomplish this goal we will need to:</p>
<ol class="arabic simple">
<li>create a postgres docker container for our Spring application</li>
<li>create and configure a project database inside of the docker container</li>
<li>add dependencies to <code class="docutils literal notranslate"><span class="pre">build.gradle</span></code></li>
<li>amend <code class="docutils literal notranslate"><span class="pre">application.properties</span></code></li>
<li>Add Annotations to Models</li>
<li>Add DataRepository</li>
<li>Run project</li>
<li>Check database</li>
<li>Working with the Data Repository</li>
</ol>
<p>We will be going through these steps with the <a class="reference external" href="https://gitlab.com/LaunchCodeTraining/spring-example" target="_blank">spring-example API<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> we worked on early this week.</p>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>If you don’t have the code fork, and clone the <a class="reference external" href="https://gitlab.com/LaunchCodeTraining/spring-example" target="_blank">spring-example API<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> to your GitLab account.</p>
<p>Let’s Explore the code, most notably the Dog.java, and DogController.java files:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Dog</span> <span class="p">{</span>

    <span class="c1">// properties</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">breed</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">age</span><span class="p">;</span>

    <span class="c1">// constructor</span>

    <span class="kd">public</span> <span class="nf">Dog</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">String</span> <span class="n">breed</span><span class="p">,</span> <span class="kt">int</span> <span class="n">age</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">breed</span> <span class="o">=</span> <span class="n">breed</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// getters() &amp; setters()</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getBreed</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="na">breed</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getAge</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="na">age</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>This is a straightforward Model, it has properties, a constructor, and getters for each property.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/dog&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DogController</span> <span class="p">{</span>

    <span class="n">Dog</span> <span class="n">newDog</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Dog</span><span class="p">(</span><span class="s">&quot;Bernie&quot;</span><span class="p">,</span> <span class="s">&quot;Basset&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

    <span class="nd">@GetMapping</span>
    <span class="kd">public</span> <span class="n">Dog</span> <span class="nf">getDog</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">newDog</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@PostMapping</span>
    <span class="kd">public</span> <span class="n">Dog</span> <span class="nf">postDog</span><span class="p">(</span><span class="nd">@RequestBody</span> <span class="n">Dog</span> <span class="n">incomingDog</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">newDog</span> <span class="o">=</span> <span class="n">incomingDog</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">newDog</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@GetMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/{id}&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Dog</span> <span class="nf">getDogById</span><span class="p">(</span><span class="nd">@PathVariable</span> <span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Dog</span><span class="p">(</span><span class="s">&quot;Samson&quot;</span><span class="p">,</span> <span class="s">&quot;Terrier&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>This is a fairly simple API right now, it supports 3 endpoints:</p>
<ul class="simple">
<li>GET <cite>/dog</cite>: returns an in memory Dog object</li>
<li>POST <cite>/dog</cite>: overwrites the in memory Dog object with incoming JSON and returns the new in memory Dog object</li>
<li>GET <cite>/dog/{id}</cite>: returns an in memory Dog object and prints out a path variable</li>
</ul>
<p>We will be making some changes to these files after configuring our Spring application to work with a PostgreSQL database.</p>
</div>
<div class="section" id="create-a-postgres-database-for-this-project">
<h2>Create a Postgres Database for this project<a class="headerlink" href="#create-a-postgres-database-for-this-project" title="Permalink to this headline">¶</a></h2>
<p>Docker allows us to easily quickly and easily create new containers and as a best practice for this class we will use a new postgres container for each of our Spring applications.</p>
<div class="section" id="stopping-other-postgres-containers">
<h3>Stopping Other Postgres Containers<a class="headerlink" href="#stopping-other-postgres-containers" title="Permalink to this headline">¶</a></h3>
<p>Before creating the postgres container for this spring example application let’s make sure there aren’t any postgres containers running on the port we will be using.</p>
<p>You can check the running containers with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker ps
</pre></div>
</div>
<p>If you have any containers (most likely postgres containers) running on port 5432 stop them with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker stop container-name
</pre></div>
</div>
</div>
<div class="section" id="creating-the-spring-example-postgres-container">
<h3>Creating the spring-example Postgres Container<a class="headerlink" href="#creating-the-spring-example-postgres-container" title="Permalink to this headline">¶</a></h3>
<p>Our next step is to create the spring-example Postgres Container. To do so we will create a new docker env file to hold the environment variables we will need for this specific container.</p>
<p>Create a new file named <code class="docutils literal notranslate"><span class="pre">spring-example-postgres.env</span></code>.</p>
<p>Add the following lines to the file:</p>
<div class="highlight-code notranslate"><div class="highlight"><pre><span></span>POSTGRES_USER=spring-example-user
POSTGRES_PASSWORD=springuserpass
ALLOW_IP_RANGE=&lt;0.0.0.0/0&gt;
</pre></div>
</div>
<p>With our environment variable file in place we can now create our container:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker run --name <span class="s2">&quot;spring-example-postgres&quot;</span> -p <span class="m">5432</span>:5432 -d -t --env-file ./spring-example-postgres.env postgres:9.4
</pre></div>
</div>
<p>You can verify that your docker container is running by checking the output of the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">ps</span></code> command.</p>
</div>
<div class="section" id="configure-database-for-project">
<h3>Configure Database for project<a class="headerlink" href="#configure-database-for-project" title="Permalink to this headline">¶</a></h3>
<p>Now that we have a database container, we need to access the psql client to create the database for this specific project.</p>
<p>You can access the psql client of your container with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker <span class="nb">exec</span> -it spring-example-postgres psql -U spring-example-user postgres
</pre></div>
</div>
<p>This command will drop you into a psql shell where you can enter SQL statements to interact with the Postgres server.</p>
<p>We want to create a database, and grant privileges to our database user for this new database from the psql shell:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">example</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">on</span> <span class="k">DATABASE</span> <span class="n">example</span> <span class="k">TO</span> <span class="ss">&quot;spring-example-user&quot;</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition-note admonition">
<p class="first admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>note</p>
<p>You may need to grant the user superuser access.</p>
<div class="last highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">USER</span> <span class="n">spring</span><span class="o">-</span><span class="n">example</span><span class="o">-</span><span class="k">user</span> <span class="k">WITH</span> <span class="n">SUPERUSER</span><span class="p">;</span>
</pre></div>
</div>
</div>
<p>Now that our container, user, and database are setup we can start working with our code.</p>
</div>
</div>
<div class="section" id="add-dependencies-to-spring-project">
<h2>Add Dependencies to Spring Project<a class="headerlink" href="#add-dependencies-to-spring-project" title="Permalink to this headline">¶</a></h2>
<p>Gradle is our build and dependency management tool. We need to inform gradle that we have new dependencies in this project and it will take care of installing and preparing the libraries for us.</p>
<p>We will be making additions to the <code class="docutils literal notranslate"><span class="pre">build.gradle</span></code> file. We are adding to the dependencies section of the build.gradle file:</p>
<div class="highlight-gradle notranslate"><div class="highlight"><pre><span></span>implementation &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;
    implementation group: &#39;org.postgresql&#39;, name: &#39;postgresql&#39;, version: &#39;42.1.4&#39;
</pre></div>
</div>
<p>After adding these new dependencies our build gradle will contain:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">build.gradle</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-gradle notranslate"><div class="highlight"><pre><span></span> dependencies {
     implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;
     developmentOnly &#39;org.springframework.boot:spring-boot-devtools&#39;
     implementation &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;
     implementation group: &#39;org.postgresql&#39;, name: &#39;postgresql&#39;, version: &#39;42.1.4&#39;
     testImplementation(&#39;org.springframework.boot:spring-boot-starter-test&#39;) {
         exclude group: &#39;org.junit.vintage&#39;, module: &#39;junit-vintage-engine&#39;
     }
 }
</pre></div>
</div>
</div>
</div>
<div class="section" id="add-database-configuration-information-to-spring-project">
<h2>Add Database Configuration Information to Spring Project<a class="headerlink" href="#add-database-configuration-information-to-spring-project" title="Permalink to this headline">¶</a></h2>
<p>Earlier we setup a postgres container and created a new database. We need to give that information to our spring project so it knows how to communicate with the PostgreSQL server.</p>
<p>We will be adding to <code class="docutils literal notranslate"><span class="pre">spring-example/src/main/resources/application.properties</span></code>:</p>
<div class="highlight-code notranslate"><div class="highlight"><pre><span></span>spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.url=jdbc:postgresql://127.0.0.1:5432/example
spring.datasource.username=spring-example-user
spring.datasource.password=springuserpass
spring.jpa.hibernate.ddl-auto=update
# echos SQL statements as they are executed by Hibernate ORM
# uncomment for debugging to view SQL
# spring.jpa.show-sql=true
# spring.jpa.properties.hibernate.format_sql=true
</pre></div>
</div>
<p>Take note of the information we are adding:</p>
<ul class="simple">
<li>the URL for our database is <code class="docutils literal notranslate"><span class="pre">127.0.0.1:5432</span></code></li>
<li>the name of our database is <code class="docutils literal notranslate"><span class="pre">example</span></code></li>
<li>the name of our user is <code class="docutils literal notranslate"><span class="pre">spring-example-user</span></code></li>
<li>the password for our user is <code class="docutils literal notranslate"><span class="pre">springuserpass</span></code></li>
</ul>
</div>
<div class="section" id="model-annotations">
<h2>Model Annotations<a class="headerlink" href="#model-annotations" title="Permalink to this headline">¶</a></h2>
<p>Now that we have configured our spring application to communicate with our database, we can utilize the Spring Data and JPA annotations to map our Models to Tables in our database.</p>
<div class="admonition-note admonition">
<p class="first admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>note</p>
<p class="last">Look over the <a class="reference external" href="https://www.baeldung.com/jpa-entities" target="_blank">Baeldung JPA Entity<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> to see some examples of some of the annotations we will be using in this article.</p>
</div>
<p>We will be flagging all our Models with the <code class="docutils literal notranslate"><span class="pre">&#64;Entity</span></code> annotation to tell Hibernate to create a Table that matches the properties of this Model. We will also need to use the <code class="docutils literal notranslate"><span class="pre">&#64;Id</span></code> annotation with an id property so the database can index the records that match our POJOs.</p>
<p>In this case we will be altering the <code class="docutils literal notranslate"><span class="pre">Pet.java</span></code> class in this way:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Dog</span> <span class="p">{</span>

    <span class="c1">// properties</span>

    <span class="nd">@Id</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>

    <span class="p">...</span> <span class="n">code</span> <span class="n">clipped</span> <span class="k">for</span> <span class="n">brevity</span> <span class="p">...</span>
</pre></div>
</div>
<div class="admonition-note admonition">
<p class="first admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>note</p>
<p class="last">Will need a default empty constructor and getters and setters for our class.</p>
</div>
</div>
<div class="section" id="datarepository">
<h2>DataRepository<a class="headerlink" href="#datarepository" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;Entity</span></code> annotation will link a model with a table in a database, but to interact with it we will need to define a new interface that extends a JpaRepository. This interface will inherit many different built in methods that will provide basic CRUD functionality out of the box.</p>
<p>Create a new directory <code class="docutils literal notranslate"><span class="pre">src/main/java/org/launchcode/springexample/data</span></code> and then we will be adding a <code class="docutils literal notranslate"><span class="pre">DogRepository.java</span></code> file to that directory.</p>
<p>Make sure the contents of this file contains the following code:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.launchcode.springexample.data</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.launchcode.vetapi.models.springexample.Dog</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.repository.JpaRepository</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="p">;</span>

<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">DogRepository</span> <span class="kd">extends</span> <span class="n">JpaRepository</span><span class="o">&lt;</span><span class="n">Dog</span><span class="p">,</span> <span class="n">Integer</span><span class="o">&gt;</span><span class="p">{</span>

<span class="p">}</span>
</pre></div>
</div>
<p>For today we will not be adding any additional methods to this interface and will be working with the built in methods that have been inherited. So we don’t need to make any additional changes to this file.</p>
</div>
<div class="section" id="working-with-the-data-repository">
<h2>Working with the Data Repository<a class="headerlink" href="#working-with-the-data-repository" title="Permalink to this headline">¶</a></h2>
<p>Now we can use the DogRepository interface anywhere in our project we need access to our database.</p>
<p>Let’s refactor our <code class="docutils literal notranslate"><span class="pre">DogController.java</span></code> to utilize this new Data Repository.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/dog&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DogController</span> <span class="p">{</span>

    <span class="c1">// Dog newDog = new Dog(&quot;Bernie&quot;, &quot;Basset&quot;, 4);</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">DogRepository</span> <span class="n">dogRepository</span><span class="p">;</span>

    <span class="nd">@GetMapping</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span> <span class="nf">getDogs</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">dogRepository</span><span class="p">.</span><span class="na">findAll</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@PostMapping</span>
    <span class="kd">public</span> <span class="n">Dog</span> <span class="nf">postDog</span><span class="p">(</span><span class="nd">@RequestBody</span> <span class="n">Dog</span> <span class="n">incomingDog</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">dogRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">incomingDog</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// http://localhost:8080/dog/15</span>

    <span class="nd">@GetMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/{id}&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Dog</span> <span class="nf">getDogById</span><span class="p">(</span><span class="nd">@PathVariable</span> <span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">dogRepository</span><span class="p">.</span><span class="na">findById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>We are using the built in methods that are inherited by the dogRepository interface notably: <code class="docutils literal notranslate"><span class="pre">findAll()</span></code>, <code class="docutils literal notranslate"><span class="pre">findById()</span></code> and <code class="docutils literal notranslate"><span class="pre">.save()</span></code>. These built in methods are providing basic creation, reading, and updating for our SQL records.</p>
</div>
<div class="section" id="try-it-out">
<h2>Try it Out!<a class="headerlink" href="#try-it-out" title="Permalink to this headline">¶</a></h2>
<p>Make some curl requests to this spring application and then make some SELECT statements from the PSQL shell to see data being written to our database.</p>
<p>Restart your server and notice how your data persists!</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>